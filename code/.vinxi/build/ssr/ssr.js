import{ssrElement as y,escape as d,mergeProps as A,ssr as u,renderToStream as k,getRequestEvent as x,createComponent as g,NoHydration as w,ssrHydrationKey as h,ssrAttribute as q}from"solid-js/web";import{toWebRequest as M,getRequestIP as P,setResponseHeader as R,setResponseStatus as $,appendResponseHeader as F,getResponseHeader as j,removeResponseHeader as H,getCookie as I,setCookie as N,eventHandler as L,sendRedirect as O,setHeader as _}from"h3";import{provideRequestEvent as D}from"solid-js/web/storage";import{lazy as B,createComponent as U}from"solid-js";const b=[{type:"page",$component:{src:"src/routes/index.tsx?pick=default&pick=$css",build:()=>import("./index.js"),import:()=>import("./index.js")},path:"/",filePath:"/Users/andrew/Documents/Dev/Projects/andrewnathanco/github/challenge/code/src/routes/index.tsx"},{type:"page",$component:{src:"src/routes/share.tsx?pick=default&pick=$css",build:()=>import("./share.js"),import:()=>import("./share.js")},path:"/share",filePath:"/Users/andrew/Documents/Dev/Projects/andrewnathanco/github/challenge/code/src/routes/share.tsx"}],z=K(b.filter(e=>e.type==="page")),J=Y(b.filter(e=>e.type==="api"));function W(e,n){const t=e.split("/").filter(Boolean);e:for(const s of J){const r=s.matchSegments;if(t.length<r.length||!s.wildcard&&t.length>r.length)continue;for(let i=0;i<r.length;i++){const l=r[i];if(l&&t[i]!==l)continue e}const a=s[`$${n}`];if(a==="skip"||a===void 0)return;const o={};for(const{type:i,name:l,index:c}of s.params)i===":"?o[l]=t[c]:o[l]=t.slice(c).join("/");return{handler:a,params:o}}}function K(e){function n(t,s,r,a){const o=Object.values(t).find(i=>r.startsWith(i.id+"/"));return o?(n(o.children||(o.children=[]),s,r.slice(o.id.length)),t):(t.push({...s,id:r,path:r.replace(/\/\([^)/]+\)/g,"")}),t)}return e.sort((t,s)=>t.path.length-s.path.length).reduce((t,s)=>n(t,s,s.path,s.path),[])}function Y(e){return e.flatMap(n=>C(n.path).map(s=>({...n,path:s}))).map(G).sort((n,t)=>t.score-n.score)}function C(e){let n=/(\/?\:[^\/]+)\?/.exec(e);if(!n)return[e];let t=e.slice(0,n.index),s=e.slice(n.index+n[0].length);const r=[t,t+=n[1]];for(;n=/^(\/\:[^\/]+)\?/.exec(s);)r.push(t+=n[1]),s=s.slice(n[0].length);return C(s).reduce((a,o)=>[...a,...r.map(i=>i+o)],[])}function G(e){const n=e.path.split("/").filter(Boolean),t=[],s=[];let r=0,a=!1;for(const[o,i]of n.entries())if(i[0]===":"){const l=i.slice(1);r+=3,t.push({type:":",name:l,index:o}),s.push(null)}else i[0]==="*"?(r-=1,t.push({type:"*",name:i.slice(1),index:o}),a=!0):(r+=4,s.push(i));return{...e,score:r,params:t,matchSegments:s,wildcard:a}}const T=Symbol("h3Event"),f=Symbol("fetchEvent"),Q={get(e,n){return n===f?e:e[n]??e[T][n]}};function V(e){return new Proxy({request:M(e),clientAddress:P(e),locals:{},[T]:e},Q)}function X(e){if(!e[f]){const n=V(e);e[f]=n}return e[f]}const Z=" ",ee={style:e=>y("style",e.attrs,()=>d(e.children),!0),link:e=>y("link",e.attrs,void 0,!0),script:e=>e.attrs.src?y("script",A(()=>e.attrs,{get id(){return e.key}}),()=>u(Z),!0):null};function E(e){let{tag:n,attrs:{key:t,...s}={key:void 0},children:r}=e;return ee[n]({attrs:s,key:t,children:r})}function te(e,n,t,s="default"){return B(async()=>{{const a=(await e.import())[s],i=(await n.inputs?.[e.src].assets()).filter(c=>c.tag==="style"||c.attrs.rel==="stylesheet");return{default:c=>[...i.map(p=>E(p)),U(a,c)]}}})}function ne(){function e(t){return{...t,...t.$$route?t.$$route.require().route:void 0,metadata:{...t.$$route?t.$$route.require().route.metadata:{},filesystem:!0},component:te(t.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:t.children?t.children.map(e):void 0}}return z.map(e)}function se(e){const n=I(e,"flash");if(!n)return;let t=JSON.parse(n);if(!t||!t.result)return[];const s=[...t.input.slice(0,-1),new Map(t.input[t.input.length-1])];return N(e,"flash","",{maxAge:0}),{url:t.url,result:t.error?new Error(t.result):t.result,input:s}}async function re(e){const n=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,R(e,"Content-Type","text/html"),Object.assign(e,{manifest:await n.json(),assets:[...await n.inputs[n.handler].assets()],initialSubmission:se(e),routes:ne(),components:{status:s=>($(e,s.code,s.text),()=>$(e,200)),header:s=>(s.append?F(e,s.name,s.value):R(e,s.name,s.value),()=>{const r=j(e,s.name);if(r&&typeof r=="string"){const a=r.split(", "),o=a.indexOf(s.value);o!==-1&&a.splice(o,1),a.length?R(e,s.name,a.join(", ")):H(e,s.name)}})},$islands:new Set})}function oe(e,n={}){return L({onRequest:n.onRequest,onBeforeResponse:n.onBeforeResponse,handler:t=>{const s=X(t);return D(s,async()=>{const r=W(new URL(s.request.url).pathname,s.request.method);if(r){const m=(await r.handler.import())[s.request.method];return s.params=r.params,await m(s)}const a=await re(s);let o={...n};if(o.onCompleteAll){const p=o.onCompleteAll;o.onCompleteAll=m=>{v(a)(m),p(m)}}else o.onCompleteAll=v(a);if(o.onCompleteShell){const p=o.onCompleteShell;o.onCompleteShell=m=>{S(a,t)(),p(m)}}else o.onCompleteShell=S(a,t);const i=k(()=>e(a),o);if(a.response&&a.response.headers.get("Location"))return O(s,a.response.headers.get("Location"));const{writable:l,readable:c}=new TransformStream;return i.pipeTo(l),c})}})}function S(e,n){return()=>{e.response&&e.response.headers.get("Location")&&($(n,302),_(n,"Location",e.response.headers.get("Location")))}}function v(e){return({write:n})=>{const t=e.response&&e.response.headers.get("Location");t&&n(`<script>window.location="${t}"<\/script>`)}}const ae=["<script",">$R = [];<\/script>"],ie=["<script",">","<\/script>"],le=["<script",' type="module"',"><\/script>"],ce=u("<!DOCTYPE html>");function ue(e){const n=x();return g(w,{get children(){return[ce,g(e.document,{get assets(){return[u(ae,h()),n.assets.map(t=>E(t))]},get scripts(){return[u(ie,h(),`window.manifest = ${JSON.stringify(n.manifest)}`),u(le,h(),q("src",d(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]}})]}})}const pe=['<head><script defer data-domain="ancgames.com" src="https://plausible.io/js/script.js"><\/script><meta charset="utf-8"><link rel="icon" href="/favicon.ico">',"</head>"],me=["<html",' lang="en">','<body><div id="app">',"</div><!--$-->","<!--/--></body></html>"],ye=oe(()=>g(ue,{document:({assets:e,children:n,scripts:t})=>u(me,h(),g(w,{get children(){return u(pe,d(e))}}),d(n),d(t))}));export{ye as default};
